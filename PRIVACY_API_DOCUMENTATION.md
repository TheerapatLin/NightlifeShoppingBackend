# Privacy & Block System API Documentation

## Overview
‡∏£‡∏∞‡∏ö‡∏ö Privacy ‡πÅ‡∏•‡∏∞ Block ‡∏ó‡∏µ‡πà‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏•‡∏∏‡∏°‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏õ‡πá‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ ‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏ö‡∏•‡πá‡∏≠‡∏Å‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ

## Features Added
- ‚úÖ **Privacy Settings**: ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏õ‡πá‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß
- ‚úÖ **User Search**: ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ (‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö privacy)
- ‚úÖ **Block System**: ‡∏ö‡∏•‡πá‡∏≠‡∏Å/‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏ö‡∏•‡πá‡∏≠‡∏Å‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ
- ‚úÖ **Profile Visibility**: ‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏Å‡∏≤‡∏£‡∏°‡∏≠‡∏á‡πÄ‡∏´‡πá‡∏ô‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå
- ‚úÖ **Chat Privacy**: ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö privacy ‡∏Å‡πà‡∏≠‡∏ô‡πÅ‡∏ä‡∏ó
- ‚úÖ **User Reporting**: ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ

---

## Privacy Settings

### User Schema Changes

#### Privacy Settings Object
```javascript
privacySettings: {
  searchable: Boolean,           // ‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡πÉ‡∏´‡πâ‡∏Ñ‡πâ‡∏ô‡πÄ‡∏à‡∏≠‡πÅ‡∏ö‡∏ö‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏∞ (default: true)
  allowDirectMessage: Boolean,   // ‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡πÉ‡∏´‡πâ‡∏ó‡∏±‡∏Å‡πÅ‡∏ä‡∏ó‡πÑ‡∏î‡πâ (default: true)
  showOnlineStatus: Boolean,     // ‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå (default: true)
  allowGroupInvite: Boolean,     // ‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡πÉ‡∏´‡πâ‡πÄ‡∏ä‡∏¥‡∏ç‡πÄ‡∏Ç‡πâ‡∏≤‡∏Å‡∏•‡∏∏‡πà‡∏° (default: true)
  profileVisibility: String     // "public", "friends", "private" (default: "public")
}
```

#### Block Lists
```javascript
blockedUsers: [{
  userId: ObjectId,              // ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ö‡∏•‡πá‡∏≠‡∏Å
  blockedAt: Date,              // ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ö‡∏•‡πá‡∏≠‡∏Å
  reason: String                // ‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•: "spam", "harassment", "inappropriate", "other"
}]

blockedBy: [{
  userId: ObjectId,              // ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏ó‡∏µ‡πà‡∏ö‡∏•‡πá‡∏≠‡∏Å‡πÄ‡∏£‡∏≤
  blockedAt: Date               // ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ö‡∏•‡πá‡∏≠‡∏Å
}]
```

---

## REST API Endpoints

### üîí Privacy Settings

#### 1. ‡∏î‡∏∂‡∏á‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏õ‡πá‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß
```http
GET /api/v1/privacy/settings
Authorization: Bearer <token>
```

**Response:**
```json
{
  "success": true,
  "privacySettings": {
    "searchable": true,
    "allowDirectMessage": true,
    "showOnlineStatus": true,
    "allowGroupInvite": true,
    "profileVisibility": "public"
  }
}
```

#### 2. ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏õ‡πá‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß
```http
PUT /api/v1/privacy/settings
Authorization: Bearer <token>
```

**Request Body:**
```json
{
  "searchable": false,
  "allowDirectMessage": true,
  "showOnlineStatus": false,
  "allowGroupInvite": true,
  "profileVisibility": "friends"
}
```

**Response:**
```json
{
  "success": true,
  "message": "‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏õ‡πá‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à",
  "privacySettings": {
    "searchable": false,
    "allowDirectMessage": true,
    "showOnlineStatus": false,
    "allowGroupInvite": true,
    "profileVisibility": "friends"
  }
}
```

---

### üö´ Block Management

#### 3. ‡∏î‡∏∂‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ö‡∏•‡πá‡∏≠‡∏Å
```http
GET /api/v1/privacy/blocked-users?page=1&limit=20
Authorization: Bearer <token>
```

**Response:**
```json
{
  "success": true,
  "blockedUsers": [
    {
      "userId": {
        "_id": "userId",
        "user": {
          "name": "John Doe",
          "email": "john@example.com"
        },
        "userData": {
          "profileImage": "https://example.com/avatar.jpg"
        }
      },
      "blockedAt": "2024-01-01T00:00:00.000Z",
      "reason": "spam"
    }
  ],
  "pagination": {
    "currentPage": 1,
    "totalItems": 5,
    "totalPages": 1,
    "hasMore": false
  }
}
```

#### 4. ‡∏ö‡∏•‡πá‡∏≠‡∏Å‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ
```http
POST /api/v1/privacy/block
Authorization: Bearer <token>
```

**Request Body:**
```json
{
  "userIdToBlock": "userId",
  "reason": "spam"
}
```

**Response:**
```json
{
  "success": true,
  "message": "‡∏ö‡∏•‡πá‡∏≠‡∏Å‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à"
}
```

#### 5. ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡∏ö‡∏•‡πá‡∏≠‡∏Å‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ
```http
POST /api/v1/privacy/unblock
Authorization: Bearer <token>
```

**Request Body:**
```json
{
  "userIdToUnblock": "userId"
}
```

**Response:**
```json
{
  "success": true,
  "message": "‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡∏ö‡∏•‡πá‡∏≠‡∏Å‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à"
}
```

#### 6. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏ö‡∏•‡πá‡∏≠‡∏Å
```http
GET /api/v1/privacy/block-status/:userId
Authorization: Bearer <token>
```

**Response:**
```json
{
  "success": true,
  "blockStatus": {
    "isBlocked": false,      // ‡∏â‡∏±‡∏ô‡∏ö‡∏•‡πá‡∏≠‡∏Å‡πÄ‡∏Ç‡∏≤
    "isBlockedBy": false,    // ‡πÄ‡∏Ç‡∏≤‡∏ö‡∏•‡πá‡∏≠‡∏Å‡∏â‡∏±‡∏ô
    "canMessage": true,      // ‡∏â‡∏±‡∏ô‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏≤‡πÄ‡∏Ç‡∏≤‡πÑ‡∏î‡πâ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
    "canSearch": true        // ‡∏â‡∏±‡∏ô‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÄ‡∏Ç‡∏≤‡πÑ‡∏î‡πâ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
  }
}
```

---

### üîç User Search & Profile

#### 7. ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ
```http
GET /api/v1/privacy/search/users?q=john&page=1&limit=20&userType=regular
Authorization: Bearer <token>
```

**Query Parameters:**
- `q`: ‡∏Ñ‡∏≥‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ (‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 2 ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£)
- `page`: ‡∏´‡∏ô‡πâ‡∏≤ (default: 1)
- `limit`: ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ï‡πà‡∏≠‡∏´‡∏ô‡πâ‡∏≤ (default: 20)
- `userType`: ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ (optional)

**Response:**
```json
{
  "success": true,
  "users": [
    {
      "_id": "userId",
      "user": {
        "name": "John Doe",
        "email": "john@example.com",
        "username": "john_doe"
      },
      "userType": "regular",
      "userData": {
        "profileImage": "https://example.com/avatar.jpg"
      },
      "privacySettings": {
        "profileVisibility": "public"
      }
    }
  ],
  "pagination": {
    "currentPage": 1,
    "totalPages": 3,
    "totalItems": 50,
    "hasMore": true
  }
}
```

**Search Logic:**
- ‡πÑ‡∏°‡πà‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏ô‡πÄ‡∏≠‡∏á
- ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏ó‡∏µ‡πà `searchable: true`
- ‡πÑ‡∏°‡πà‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏ó‡∏µ‡πà‡∏ö‡∏•‡πá‡∏≠‡∏Å‡∏Å‡∏±‡∏ô
- ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏à‡∏≤‡∏Å name, email, username
- ‡∏Å‡∏£‡∏≠‡∏á‡∏ï‡∏≤‡∏° profileVisibility

#### 8. ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ
```http
GET /api/v1/privacy/user/:userId
Authorization: Bearer <token>
```

**Response:**
```json
{
  "success": true,
  "user": {
    "_id": "userId",
    "user": {
      "name": "John Doe",
      "email": "john@example.com",
      "username": "john_doe"
    },
    "userType": "regular",
    "userData": {
      "profileImage": "https://example.com/avatar.jpg",
      "gender": "male",
      "birthday": "1990-01-01T00:00:00.000Z"
    },
    "privacySettings": {
      "profileVisibility": "public"
    }
  }
}
```

**Access Control:**
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏ö‡∏•‡πá‡∏≠‡∏Å
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö profileVisibility
- ‡πÑ‡∏°‡πà‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß (password, token, blockedUsers)

#### 9. ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ
```http
POST /api/v1/privacy/report
Authorization: Bearer <token>
```

**Request Body:**
```json
{
  "userId": "userIdToReport",
  "reason": "harassment",
  "description": "This user is sending inappropriate messages"
}
```

**Response:**
```json
{
  "success": true,
  "message": "‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‡∏ó‡∏µ‡∏°‡∏á‡∏≤‡∏ô‡∏à‡∏∞‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÅ‡∏•‡∏∞‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡πà‡∏≠‡πÑ‡∏õ"
}
```

---

## Chat Integration

### Privacy Checks in Chat

‡∏£‡∏∞‡∏ö‡∏ö Chat ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Privacy ‡πÅ‡∏•‡∏∞ Block ‡∏Å‡πà‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£:

#### ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏´‡πâ‡∏≠‡∏á‡πÅ‡∏ä‡∏ó‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß
```javascript
// ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡πà‡∏≠‡∏ô‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏´‡πâ‡∏≠‡∏á‡πÅ‡∏ä‡∏ó
if (currentUser.isBlocked(otherUserId) || currentUser.isBlockedBy(otherUserId)) {
  return "‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏´‡πâ‡∏≠‡∏á‡πÅ‡∏ä‡∏ó‡πÑ‡∏î‡πâ‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏ö‡∏•‡πá‡∏≠‡∏Å‡∏Å‡∏±‡∏ô";
}

if (!otherUser.canReceiveMessageFrom(userId)) {
  return "‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡πÉ‡∏´‡πâ‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏≤‡∏Å‡∏Ñ‡∏∏‡∏ì";
}
```

#### ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°
```javascript
// ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡πà‡∏≠‡∏ô‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°
if (currentUser.isBlocked(otherUserId) || currentUser.isBlockedBy(otherUserId)) {
  return "‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÑ‡∏î‡πâ‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏ö‡∏•‡πá‡∏≠‡∏Å‡∏Å‡∏±‡∏ô";
}
```

---

## User Schema Methods

### Instance Methods

#### Privacy Methods
```javascript
// ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÑ‡∏î‡πâ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
user.canBeSearchedBy(searcherId)

// ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÑ‡∏î‡πâ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
user.canReceiveMessageFrom(senderId)
```

#### Block Methods
```javascript
// ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏ö‡∏•‡πá‡∏≠‡∏Å‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
user.isBlocked(userId)

// ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏ñ‡∏π‡∏Å‡∏ö‡∏•‡πá‡∏≠‡∏Å‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
user.isBlockedBy(userId)

// ‡∏ö‡∏•‡πá‡∏≠‡∏Å‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ
await user.blockUser(userIdToBlock, reason)

// ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡∏ö‡∏•‡πá‡∏≠‡∏Å
await user.unblockUser(userIdToUnblock)
```

---

## Test Data

### ‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏î‡∏™‡∏≠‡∏ö
```bash
# ‡∏£‡∏±‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏î‡∏™‡∏≠‡∏ö
npm run seed:chat-privacy

# ‡∏´‡∏£‡∏∑‡∏≠
node scripts/runSeed.js chat-privacy
```

### Test Accounts
| Email | Password | Privacy Settings | Notes |
|-------|----------|------------------|-------|
| alice@example.com | password123 | ‡∏õ‡∏Å‡∏ï‡∏¥‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î | ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÅ‡∏ä‡∏ó‡πÑ‡∏î‡πâ‡∏õ‡∏Å‡∏ï‡∏¥ |
| bob@example.com | password123 | ‡πÑ‡∏°‡πà‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå | showOnlineStatus=false |
| charlie@example.com | password123 | ‡πÑ‡∏°‡πà‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡πÉ‡∏´‡πâ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ | searchable=false |
| diana@example.com | password123 | ‡πÑ‡∏°‡πà‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡πÉ‡∏´‡πâ‡∏ó‡∏±‡∏Å‡πÅ‡∏ä‡∏ó | allowDirectMessage=false |
| eve@example.com | password123 | ‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß | profileVisibility=private |
| frank@example.com | password123 | ‡∏õ‡∏Å‡∏ï‡∏¥ | ‡∏ö‡∏•‡πá‡∏≠‡∏Å Charlie ‡πÅ‡∏•‡πâ‡∏ß |

### Test Scenarios

#### 1. ‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ
```bash
# ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ "charlie" - ‡∏à‡∏∞‡πÑ‡∏°‡πà‡πÄ‡∏à‡∏≠‡πÄ‡∏û‡∏£‡∏≤‡∏∞ searchable=false
GET /api/v1/privacy/search/users?q=charlie

# ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ "alice" - ‡∏à‡∏∞‡πÄ‡∏à‡∏≠‡∏õ‡∏Å‡∏ï‡∏¥
GET /api/v1/privacy/search/users?q=alice
```

#### 2. ‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏´‡πâ‡∏≠‡∏á‡πÅ‡∏ä‡∏ó
```bash
# Alice ‡πÅ‡∏ä‡∏ó‡∏Å‡∏±‡∏ö Bob - ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à
POST /api/v1/chat/rooms
{
  "name": "Alice & Bob",
  "type": "private", 
  "participants": ["aliceId", "bobId"]
}

# Alice ‡πÅ‡∏ä‡∏ó‡∏Å‡∏±‡∏ö Diana - ‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß (Diana ‡πÑ‡∏°‡πà‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡πÉ‡∏´‡πâ‡∏ó‡∏±‡∏Å‡πÅ‡∏ä‡∏ó)
POST /api/v1/chat/rooms
{
  "name": "Alice & Diana",
  "type": "private",
  "participants": ["aliceId", "dianaId"]
}

# Frank ‡πÅ‡∏ä‡∏ó‡∏Å‡∏±‡∏ö Charlie - ‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß (Frank ‡∏ö‡∏•‡πá‡∏≠‡∏Å Charlie)
POST /api/v1/chat/rooms
{
  "name": "Frank & Charlie", 
  "type": "private",
  "participants": ["frankId", "charlieId"]
}
```

#### 3. ‡∏Å‡∏≤‡∏£‡∏î‡∏π‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå
```bash
# ‡∏î‡∏π‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå Eve - ‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß (‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß)
GET /api/v1/privacy/user/eveId

# ‡∏î‡∏π‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå Alice - ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à (‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏∞)
GET /api/v1/privacy/user/aliceId
```

---

## Privacy Logic Flow

### User Search Flow
```
1. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ (‡∏ï‡πâ‡∏≠‡∏á >= 2 ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£)
2. ‡∏™‡∏£‡πâ‡∏≤‡∏á query:
   - ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á
   - searchable = true
   - ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ö‡∏•‡πá‡∏≠‡∏Å‡∏Å‡∏±‡∏ô
   - ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö name/email/username
3. ‡∏Å‡∏£‡∏≠‡∏á‡∏ï‡∏≤‡∏° profileVisibility
4. ‡∏™‡πà‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå
```

### Chat Creation Flow
```
1. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô
2. ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö private chat:
   - ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏ö‡∏•‡πá‡∏≠‡∏Å
   - ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö allowDirectMessage
   - ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏´‡πâ‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß
3. ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏´‡πâ‡∏≠‡∏á‡πÅ‡∏ä‡∏ó
```

### Message Sending Flow
```
1. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å
2. ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö private chat:
   - ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏ö‡∏•‡πá‡∏≠‡∏Å
   - ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö allowDirectMessage
3. ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°
```

---

## Error Codes

| Code | Message | Description |
|------|---------|-------------|
| 400 | ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏‡∏Ñ‡∏≥‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 2 ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£ | ‡∏Ñ‡∏≥‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏™‡∏±‡πâ‡∏ô‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ |
| 400 | ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ö‡∏•‡πá‡∏≠‡∏Å‡∏ï‡∏ô‡πÄ‡∏≠‡∏á‡πÑ‡∏î‡πâ | ‡∏û‡∏¢‡∏≤‡∏¢‡∏≤‡∏°‡∏ö‡∏•‡πá‡∏≠‡∏Å‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á |
| 403 | ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏´‡πâ‡∏≠‡∏á‡πÅ‡∏ä‡∏ó‡πÑ‡∏î‡πâ‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏ö‡∏•‡πá‡∏≠‡∏Å‡∏Å‡∏±‡∏ô | ‡∏ñ‡∏π‡∏Å‡∏ö‡∏•‡πá‡∏≠‡∏Å‡∏´‡∏£‡∏∑‡∏≠‡∏ö‡∏•‡πá‡∏≠‡∏Å‡∏Å‡∏±‡∏ô |
| 403 | ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡πÉ‡∏´‡πâ‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏≤‡∏Å‡∏Ñ‡∏∏‡∏ì | allowDirectMessage = false |
| 403 | ‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß | profileVisibility = private |
| 404 | ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ | User ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà |

---

## Best Practices

### 1. Privacy by Design
- ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ default ‡πÉ‡∏´‡πâ‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢
- ‡πÉ‡∏´‡πâ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡πÑ‡∏î‡πâ‡∏ó‡∏∏‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏ó‡∏∏‡∏Å action

### 2. Performance Optimization
- ‡πÉ‡∏ä‡πâ indexes ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤
- Cache ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏ö‡πà‡∏≠‡∏¢
- Pagination ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏¢‡∏≤‡∏ß

### 3. User Experience
- ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•‡πÄ‡∏°‡∏∑‡πà‡∏≠ action ‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß
- ‡πÉ‡∏´‡πâ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô
- ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡∏ö‡∏•‡πá‡∏≠‡∏Å

### 4. Security
- ‡πÑ‡∏°‡πà‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏ú‡∏¢‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß
- Log ‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏ó‡∏≥‡∏ó‡∏µ‡πà‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç
- Rate limiting ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤

---

## Future Enhancements

### 1. Friends System
- ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô
- ‡∏Å‡∏£‡∏≠‡∏á profileVisibility = "friends"
- Friend requests

### 2. Advanced Reporting
- ‡∏™‡∏£‡πâ‡∏≤‡∏á UserReport schema
- Admin panel ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô
- Automated moderation

### 3. Temporary Blocks
- Block ‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß (‡∏°‡∏µ‡∏ß‡∏±‡∏ô‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏)
- Auto-unblock ‡∏´‡∏•‡∏±‡∏á‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤

### 4. Group Privacy
- ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ privacy ‡∏Ç‡∏≠‡∏á‡∏Å‡∏•‡∏∏‡πà‡∏°
- ‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡πÉ‡∏´‡∏°‡πà
- Admin controls

‡∏£‡∏∞‡∏ö‡∏ö Privacy ‡πÅ‡∏•‡∏∞ Block ‡∏ô‡∏µ‡πâ‡πÉ‡∏´‡πâ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏Å‡∏≤‡∏£‡∏°‡∏≠‡∏á‡πÄ‡∏´‡πá‡∏ô‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£‡πÑ‡∏î‡πâ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÉ‡∏ô‡∏£‡∏∞‡∏î‡∏±‡∏ö Production! üîí
